module test_pet_priestly
  use funit
  use mo_pet, only : pet_priestly
  use mo_kind, only : dp

  implicit none

  private
  
  public :: test_priestly

contains

  @test
  subroutine test_priestly()

    real(dp) :: reference = 4.978_dp
    real(dp) :: calc_pet
    
    calc_pet = pet_priestly(1.26_dp, 200.0_dp, 10.0_dp)
    @assertEqual(reference, calc_pet, tolerance=0.001, message='PET Priestley-Taylor')
    
  end subroutine test_priestly

end module test_pet_priestly

